<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horarios</title>

    <style>
        :root{
            --color-yellow: #FCB814;
            --color-black: #221F20;
        }

        body{
            width: 100%;
            height: 100dvh;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 0;
            margin: 0;
        }

        header{
            width: 100%;
            height: 8%;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            background-color: var(--color-black);
            padding: 0;
            margin: 0;
        }

        header a{
            width: 3rem;
            height: 3rem;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0 3rem 0 3rem;
            margin: 0;
        }

        header a img{
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        main{
            width: 100%;
            height: 92%;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            background-color: var(--color-yellow);
            padding: 0;
            margin: 0;
        }
    </style>

</head>
<body>

    <header>
        <a href=""><img src="./assets/ICON-BRUTO-FI-YELLOW.png" alt="LOGO"></a>
    </header>

    <main>
        <button class="button_accion" id="button_accion">Descargar excel</button>
    </main>
    
    <script src="https://cdn.sheetjs.com/xlsx-0.19.3/package/dist/xlsx.full.min.js"></script>
    <script>

        let button_accion = document.getElementById("button_accion")

        const Universidad = {
            nombre_universidad: "UPMH",
            carreras: []
        }

        // --- CLASES ESTRUCTURALES ---

        class Carrera {
            constructor(nombre_carrera) {
                this.nombre_carrera = nombre_carrera
                this.especialidades = []
            }

            agregarEspecialidad(especialidad) {
                if (especialidad instanceof Especialidad) {
                    this.especialidades.push(especialidad)
                }
            }
        }

        const DIAS = ["lunes", "martes", "miercoles", "jueves", "viernes", "sabado"]
        const HORAS = [7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]

        let LAGE = new Carrera("LAGE")

        Universidad.carreras.push(LAGE)

        class Especialidad {
            constructor(nombre_especialidad) {
                this.nombre_especialidad = nombre_especialidad
                this.grados = []
            }

            agregarGrado(grado) {
                if (grado instanceof Grado) {
                    this.grados.push(grado)
                }
            }
        }

        //Especialidades LAGE
        let LAGE_NA = new Especialidad("NA")
        let LAGE_GCH = new Especialidad("GCH")
        let LAGE_EFEP = new Especialidad("EFEP")

        LAGE.agregarEspecialidad(LAGE_NA)
        LAGE.agregarEspecialidad(LAGE_GCH)
        LAGE.agregarEspecialidad(LAGE_EFEP)

        class Grado {
            constructor(nombre_grado) {
                this.nombre_grado = nombre_grado
                this.grupos = []
            }

            agregarGrupo(grupo) {
                if (grupo instanceof Grupo) {
                    this.grupos.push(grupo)
                }
            }
        }

        //creamos los grados
        let LAGE_1ro = new Grado("LAGE_1ro")
        let LAGE_2do = new Grado("LAGE_2do")
        let LAGE_3ro = new Grado("LAGE_3ro")
        let LAGE_4to = new Grado("LAGE_4to")
        let LAGE_5to = new Grado("LAGE_5to")
        let LAGE_6to = new Grado("LAGE_6to")
        let LAGE_7mo = new Grado("LAGE_7mo")
        let LAGE_8vo = new Grado("LAGE_8vo")
        let LAGE_9no = new Grado("LAGE_9no")

        //asignamos cada grado a cada especialidad correspondiente
        LAGE_NA.agregarGrado(LAGE_1ro)
        LAGE_NA.agregarGrado(LAGE_2do)
        LAGE_NA.agregarGrado(LAGE_3ro)
        LAGE_NA.agregarGrado(LAGE_7mo)
        LAGE_NA.agregarGrado(LAGE_8vo)
        LAGE_NA.agregarGrado(LAGE_9no)

        LAGE_GCH.agregarGrado(LAGE_4to)
        LAGE_GCH.agregarGrado(LAGE_5to)

        LAGE_EFEP.agregarGrado(LAGE_4to)
        LAGE_EFEP.agregarGrado(LAGE_5to)

        
        // --- CLASE MATERIA ---
        class Materia {
            constructor(nombre_materia, horas_materia, grado_materia, turno_materia, tsu_materia) {
                this.nombre_materia = nombre_materia;
                this.horas_materia = horas_materia;
                this.grado_materia = grado_materia;
                this.turno_materia = turno_materia;
                this.tsu_materia = tsu_materia;
                this.docente = null; // Inicializa la referencia al docente

                this.desglose_horas = {
                    horas_clase_1: 0,
                    horas_clase_2: 0,
                    horas_clase_3: 0,
                    horas_clase_4: 0,
                    horas_clase_5: 0
                }
            }

            determinar_horas_clase_por_materia(){
                const tipo = this.docente.tipo_docente;
                const horas = this.horas_materia;
                // Referencia corta para no escribir tanto
                const d = this.desglose_horas; 
                        
                // Particion para Ingles (Tipo 1)
                if (tipo === 1) {
                    if (horas == 5) { d.horas_clase_1 = 2; d.horas_clase_2 = 2; d.horas_clase_3 = 1; }
                    else if (horas == 6) { d.horas_clase_1 = 2; d.horas_clase_2 = 2; d.horas_clase_3 = 2; }
                    else if (horas == 7) { d.horas_clase_1 = 2; d.horas_clase_2 = 2; d.horas_clase_3 = 2; d.horas_clase_4 = 1; }
                    else if (horas == 8) { d.horas_clase_1 = 2; d.horas_clase_2 = 2; d.horas_clase_3 = 2; d.horas_clase_4 = 2; }
                    else if (horas == 9) { d.horas_clase_1 = 2; d.horas_clase_2 = 2; d.horas_clase_3 = 2; d.horas_clase_4 = 2; d.horas_clase_5 = 1; }
                    else if (horas == 10) { d.horas_clase_1 = 2; d.horas_clase_2 = 2; d.horas_clase_3 = 2; d.horas_clase_4 = 2; d.horas_clase_5 = 2; }
                    else if (horas == 15) { d.horas_clase_1 = 3; d.horas_clase_2 = 3; d.horas_clase_3 = 3; d.horas_clase_4 = 3; d.horas_clase_5 = 3; }
                    else if (horas == 20) { d.horas_clase_1 = 4; d.horas_clase_2 = 4; d.horas_clase_3 = 4; d.horas_clase_4 = 4; d.horas_clase_5 = 4; }
                }
                // Particion para PA, PTC y Admin (Tipo 2, 3, 4)
                else {
                    if (horas == 2) { d.horas_clase_1 = 1; d.horas_clase_2 = 1; }
                    else if (horas == 3) { d.horas_clase_1 = 2; d.horas_clase_2 = 1; }
                    else if (horas == 4) { d.horas_clase_1 = 2; d.horas_clase_2 = 2; }
                    else if (horas == 5) { d.horas_clase_1 = 2; d.horas_clase_2 = 2; d.horas_clase_3 = 1; }
                    else if (horas == 6) { d.horas_clase_1 = 2; d.horas_clase_2 = 2; d.horas_clase_3 = 2; }
                    else if (horas == 7) { 
                        if (tipo === 2) { d.horas_clase_1 = 3; d.horas_clase_2 = 2; d.horas_clase_3 = 2; }
                        else { d.horas_clase_1 = 2; d.horas_clase_2 = 2; d.horas_clase_3 = 2; d.horas_clase_4 = 1; }
                    }
                }

            }

            asignarDocente(docente) {
                if (docente instanceof Docente) {
                    this.docente = docente;
                    docente.agregarMateria(this); 
                    // ¡Llamarlo aquí asegura que las horas se repartan en cuanto llega el docente!
                    this.determinar_horas_clase_por_materia(); 
                }
            }
        }
        
        // Materias 1° cuatrimestre LAGE_NA
        let TUTORIA_1RO = new Materia("TUTORIA 1RO", 2, 1, "MATUTINO", "NA")
        let DESARROLLO_HUMANO_Y_VALORES = new Materia("DESARROLLO HUMANO Y VALORES", 4, 1, "MATUTINO", "NA");
        let FUNDAMENTOS_MATEMATICOS = new Materia("FUNDAMENTOS MATEMATICOS", 7, 1, "MATUTINO", "GCH");
        let FUNDAMENTOS_DE_LA_ADMINISTRACION = new Materia("FUNDAMENTOS DE LA ADMINISTRACION", 4, 1, "MATUTINO", "NA");
        let CONTABILIDAD_I = new Materia("CONTABILIDAD I", 6, 1, "MATUTINO", "NA");
        let MARCO_LEGAL_DE_LAS_ORGANIZACIONES = new Materia("MARCO LEGAL DE LAS ORGANIZACIONES", 4, 1, "MATUTINO", "NA");
        let COMUNICACION_Y_HABILIDADES_DIGITALES = new Materia("COMUNICACION Y HABILIDADES DIGITALES", 5, 1, "MATUTINO", "NA");
        let INGLES_I = new Materia("INGLES I", 15, 1, "MATUTINO", "NA");

        // Materias 4° cuatrimestre (Gestion del capital humano / GCH) 
        let TUTORIA_4TO_GCH = new Materia("TUTORIA 4TO GCH", 2, 4, "VESPERTINO", "GCH")
        let ETICA_PROFESIONAL_GCH = new Materia("ETICA PROFESIONAL", 4, 4, "VESPERTINO", "GCH");
        let GESTION_DEL_CAPITAL_HUMANO = new Materia("GESTION DEL CAPITAL HUMANO", 5, 4, "VESPERTINO", "GCH");
        let INTEGRACIÓN_DEL_CAPITAL_HUMANO = new Materia("INTEGRACION DEL CAPITAL HUMANO", 5, 4, "VESPERTINO", "GCH");
        let COMPORTAMIENTO_ORGANIZACIONAL = new Materia("COMPORTAMIENTO ORGANIZACIONAL", 5, 4, "VESPERTINO", "GCH");
        let SUELDOS_Y_SALARIOS_I = new Materia("SUELDOS Y SALARIOS I", 7, 4, "VESPERTINO", "GCH");
        let LEGISLACION_LABORAL = new Materia("LEGISLACION LABORAL", 4, 4, "VESPERTINO", "GCH");
        let INGLES_IV_GCH = new Materia("INGLES IV", 8, 4, "VESPERTINO", "GCH");

        // Materias 4° cuatrimestre (Emprendimiento y formulacion y evaluacion de proyectos / EFEP)
        let TUTORIA_4TO_EFEP = new Materia("TUTORIA 4TO EFEP", 2, 4, "VESPERTINO", "EFEP")
        let ETICA_PROFESIONAL_EFEP = new Materia("ETICA PROFESIONAL", 4, 4, "VESPERTINO", "EFEP");
        let INNOVACION_Y_EMPRENDIMIENTO = new Materia("INNOVACION Y EMPRENDIMIENTO", 5, 4, "VESPERTINO", "EFEP");
        let ESTUDIO_DE_MERCADO = new Materia("ESTUDIO DE MERCADO", 6, 4, "VESPERTINO", "EFEP");
        let ADMINISTRACIÓN_DE_PROYECTOS_I = new Materia("ESTUDIO DE MERCADO", 5, 4, "VESPERTINO", "EFEP");
        let FUNDAMENTOS_DE_SISTEMAS_DE_PRODUCCIÓN = new Materia("FUNDAMENTOS DE SISTEMAS DE PRODUCCION", 4, 4, "VESPERTINO", "EFEP");
        let ESTUDIO_TÉCNICO_Y_ORGANIZACIONAL = new Materia("ESTUDIO TÉCNICO Y ORGANIZACIONAL", 6, 4, "VESPERTINO", "EFEP");
        let INGLES_IV_EFEP = new Materia("INGLES IV", 8, 4, "VESPERTINO", "EFEP");

        // Materias 7° cuatrimestre LAGE_NA
        let TUTORIA_7MO = new Materia("TUTORIA 7MO", 2, 7, "VESPERTINO", "NA")
        let COMERCIO_INTERNACIONAL = new Materia("COMERCIO INTERNACIONAL", 5, 7, "VESPERTINO", "NA")
        let SUSTENTABILIDAD = new Materia("SUSTENTABILIDAD", 5, 7, "VESPERTINO", "NA")
        let CONTRIBUCIONES_FISCALES = new Materia("CONTRIBUCIONES FISCALES", 6, 7, "VESPERTINO", "NA")
        let ADMINISTRACION_DE_LA_PRODUCCION = new Materia("ADMINISTRACION DE LA PRODUCCION", 6, 7, "VESPERTINO", "NA")
        let TECNOLOGIAS_DE_LA_INFORMACION_APLICADA_A_LOS_NEGOCIOS = new Materia("TECNOLOGIAS DE LA INFORMACION APLICADA A LOS NEGOCIOS", 4, 7, "VESPERTINO", "NA")
        let SEMINARIO_DE_LA_INNOVACION = new Materia("SEMINARIO DE LA INNOVACION", 5, 7, "VESPERTINO", "NA")
        let INGLES_VII_EFEP = new Materia("INGLES VII", 5, 7, "VESPERTINO", "EFEP")

        let lista_materias_LAGE_1ro = [
            TUTORIA_1RO,
            DESARROLLO_HUMANO_Y_VALORES,
            FUNDAMENTOS_MATEMATICOS,
            FUNDAMENTOS_DE_LA_ADMINISTRACION,
            CONTABILIDAD_I,
            MARCO_LEGAL_DE_LAS_ORGANIZACIONES,
            COMUNICACION_Y_HABILIDADES_DIGITALES,
            INGLES_I
        ]

        let lista_materias_LAGE_4to_GCH = [
            TUTORIA_4TO_GCH,
            ETICA_PROFESIONAL_GCH,
            GESTION_DEL_CAPITAL_HUMANO,
            INTEGRACIÓN_DEL_CAPITAL_HUMANO,
            COMPORTAMIENTO_ORGANIZACIONAL,
            SUELDOS_Y_SALARIOS_I,
            LEGISLACION_LABORAL,
            INGLES_IV_GCH
        ]

        let lista_materias_LAGE_4to_EFEP = [
            TUTORIA_4TO_EFEP,
            ETICA_PROFESIONAL_EFEP,
            INNOVACION_Y_EMPRENDIMIENTO,
            ESTUDIO_DE_MERCADO,
            ADMINISTRACIÓN_DE_PROYECTOS_I,
            FUNDAMENTOS_DE_SISTEMAS_DE_PRODUCCIÓN,
            ESTUDIO_TÉCNICO_Y_ORGANIZACIONAL,
            INGLES_IV_EFEP
        ]

        let lista_materias_LAGE_7mo = [
            TUTORIA_7MO,
            COMERCIO_INTERNACIONAL,
            SUSTENTABILIDAD,
            CONTRIBUCIONES_FISCALES,
            ADMINISTRACION_DE_LA_PRODUCCION,
            TECNOLOGIAS_DE_LA_INFORMACION_APLICADA_A_LOS_NEGOCIOS,
            SEMINARIO_DE_LA_INNOVACION,
            INGLES_VII_EFEP
        ]

        //creamos la clase Grupo
        class Grupo {
            static lista_grupos_LAGE = []


            constructor(nombre_grupo, horario_lunes, horario_martes, horario_miercoles, horario_jueves, horario_viernes, horario_sabado, listaMateriasPlantilla = []) {
                this.nombre_grupo = nombre_grupo
                this.horario_lunes = horario_lunes
                this.horario_martes = horario_martes
                this.horario_miercoles = horario_miercoles
                this.horario_jueves = horario_jueves
                this.horario_viernes = horario_viernes
                this.horario_sabado = horario_sabado
                this.materias = []

                // Si pasamos una lista al crear el grupo, las clonamos automáticamente
                listaMateriasPlantilla.forEach(materia => {
                    this.agregarMateria(materia);
                })

                Grupo.lista_grupos_LAGE.push(this)
            }

            agregarMateria(materia) {
                if (materia instanceof Materia) {
                    // Creamos un nuevo objeto Materia con los mismos datos 
                    // para que cada grupo tenga su propia instancia única
                    const materiaClonada = new Materia(
                        materia.nombre_materia,
                        materia.horas_materia,
                        materia.grado_materia,
                        materia.turno_materia,
                        materia.tsu_materia
                    );
                    this.materias.push(materiaClonada);
                }
            }

            asignarDocenteAMateria(nombreMateria, docente) {
                const materia = this.materias.find(m => m.nombre_materia === nombreMateria);

                if (materia) {
                    materia.asignarDocente(docente);
                } else {
                    // Cambiamos this.nombre por this.nombre_grupo
                    console.error(`La materia "${nombreMateria}" no existe en el grupo ${this.nombre_grupo}`);
                }
            }

        }

        //creamos los grupos de LAGE
        let LAGE_1ro_NA_A = new Grupo("LAGE_1ro_NA_A", "7-16", "7-16", "7-16", "7-16", "7-16", "-", lista_materias_LAGE_1ro)
        let LAGE_1ro_NA_B = new Grupo("LAGE_1ro_NA_B", "7-16", "7-16", "7-16", "7-16", "7-16", "-", lista_materias_LAGE_1ro)
        let LAGE_1ro_NA_C = new Grupo("LAGE_1ro_NA_C", "7-16", "7-16", "7-16", "7-16", "7-16", "-", lista_materias_LAGE_1ro)

        let LAGE_4to_GCH_A = new Grupo("LAGE_4to_GCH_A", "12-20", "12-20", "12-20", "12-20", "12-20", "-", lista_materias_LAGE_4to_GCH)
        
        let LAGE_4to_EFEP_A = new Grupo("LAGE_4to_EFEP_A", "12-20", "12-20", "12-20", "12-20", "12-20", "-", lista_materias_LAGE_4to_EFEP)
        let LAGE_4to_EFEP_B = new Grupo("LAGE_4to_EFEP_B", "12-20", "12-20", "12-20", "12-20", "12-20", "-", lista_materias_LAGE_4to_EFEP)

        let LAGE_7mo_NA_A = new Grupo("LAGE_7mo_NA_A", "12-20", "12-20", "12-20", "12-20", "12-20", "-", lista_materias_LAGE_7mo)
        let LAGE_7mo_NA_B = new Grupo("LAGE_7mo_NA_B", "12-20", "12-20", "12-20", "12-20", "12-20", "-", lista_materias_LAGE_7mo)
        let LAGE_7mo_NA_C = new Grupo("LAGE_7mo_NA_C", "12-20", "12-20", "12-20", "12-20", "12-20", "-", lista_materias_LAGE_7mo)




            // --- CLASE DOCENTE
            class Docente {
                static lista_docentes = []

                constructor(nombre_docente, dispoinibilidad_lunes, dispoinibilidad_martes, dispoinibilidad_miercoles, dispoinibilidad_jueves, dispoinibilidad_viernes, dispoinibilidad_sabado, tipo_docente) {
                    this.nombre_docente = nombre_docente

                    this.dispoinibilidad_lunes = dispoinibilidad_lunes;
                    this.horas_lunes = 0;
                    this.lista_horas_lunes_docente = this.generar_lista_disponibilidad_por_dia_docente(dispoinibilidad_lunes)

                    this.dispoinibilidad_martes = dispoinibilidad_martes
                    this.horas_martes = 0;
                    this.lista_horas_martes_docente = this.generar_lista_disponibilidad_por_dia_docente(dispoinibilidad_martes)

                    this.dispoinibilidad_miercoles = dispoinibilidad_miercoles
                    this.horas_miercoles = 0;
                    this.lista_horas_miercoles_docente = this.generar_lista_disponibilidad_por_dia_docente(dispoinibilidad_miercoles)

                    this.dispoinibilidad_jueves = dispoinibilidad_jueves
                    this.horas_jueves = 0;
                    this.lista_horas_jueves_docente = this.generar_lista_disponibilidad_por_dia_docente(dispoinibilidad_jueves)

                    this.dispoinibilidad_viernes = dispoinibilidad_viernes
                    this.horas_viernes = 0
                    this.lista_horas_viernes_docente = this.generar_lista_disponibilidad_por_dia_docente(dispoinibilidad_viernes)

                    this.dispoinibilidad_sabado = dispoinibilidad_sabado
                    this.horas_sabado = 0
                    this.lista_horas_sabado_docente = this.generar_lista_disponibilidad_por_dia_docente(dispoinibilidad_sabado)

                    this.tipo_docente = tipo_docente //1 = Ingles, 2 = PA, 3 = PTC, 4 = administractivos
                    this.horas_carga = 0
                    this.horas_disponibilidad = 0
                    this.cantidad_dias_disponibles = 0
                    this.prioridad = 0
                    this.materias_impartidas_docente = []

                    Docente.lista_docentes.push(this)

                }

                //Funcion que crea las listas de horarios de los docentes (Con esto ya empezamos a considerar horarios)
                generar_lista_disponibilidad_por_dia_docente(str){
                    if (!str || str === "-") return [];
        
                        let horas = [];
                        const grupos = str.split(" ");
                                                            grupos.forEach(grupo => {
                            const [inicio, fin] = grupo.split("-").map(Number);
                            for (let i = inicio; i < fin; i++) {
                                horas.push(i);
                            }
                        })
                        return horas;
                }
                    
                agregarMateria(materia) {
                    // Evitamos duplicar la misma instancia de materia en la lista del docente
                    if (!this.materias_impartidas_docente.includes(materia)) {
                        this.materias_impartidas_docente.push(materia);
                        this.horas_carga += materia.horas_materia;                        
                    }
                }
            
            }

        let Alonzo_Lara_Flores = new Docente("Alonzo Lara Flores", "7-15 17-21", "9-17", "9-17", "7-15", "7-15", "-", 4)
        let Andres_Dimas_Espino = new Docente("Andres Dimas Espino", "12-21", "9-17", "7-14", "7-15", "7-15", "-", 4)

        //Funcion para calcular las horas disponibles de los docentes por dia
        function calcularHorasDisponibles(disponibilidad_cadena) {
            
            if (disponibilidad_cadena === "-" || disponibilidad_cadena.trim() === "") {
                return 0;
            }

            const total_horas = disponibilidad_cadena
            .split(" ")
            .map(rango => {
                const [inicio, fin] = rango.split("-").map(h => parseInt(h))

                if (isNaN(inicio) || isNaN(fin)) {
                    return 0;
                }

                return fin - inicio;
            })
            .reduce((acumulador, duracion) => {
                return acumulador + duracion
            }, 0);

            return total_horas;
        }

        // bucle para calcular la cantidad de horas disponibles por docente
        for (const docente of Docente.lista_docentes) {
            docente.horas_lunes = calcularHorasDisponibles(docente.dispoinibilidad_lunes)
            docente.horas_martes = calcularHorasDisponibles(docente.dispoinibilidad_martes)
            docente.horas_miercoles = calcularHorasDisponibles(docente.dispoinibilidad_miercoles)
            docente.horas_jueves = calcularHorasDisponibles(docente.dispoinibilidad_jueves)
            docente.horas_viernes = calcularHorasDisponibles(docente.dispoinibilidad_viernes)
            docente.horas_sabado = calcularHorasDisponibles(docente.dispoinibilidad_sabado)

            docente.horas_disponibilidad = docente.horas_lunes + docente.horas_martes + docente.horas_miercoles + docente.horas_jueves + docente.horas_viernes + docente.horas_sabado
        }


        //Asignacion docente-materia-grupo
        LAGE_1ro_NA_C.asignarDocenteAMateria("FUNDAMENTOS MATEMATICOS", Alonzo_Lara_Flores)
        LAGE_1ro_NA_C.asignarDocenteAMateria("TUTORIA 1RO", Alonzo_Lara_Flores)

        console.log(Alonzo_Lara_Flores.nombre_docente)
        console.log(Alonzo_Lara_Flores.horas_carga)
        console.log(Alonzo_Lara_Flores.materias_impartidas_docente)
        Alonzo_Lara_Flores.materias_impartidas_docente.forEach((materia, index) => {
    console.log(`--- Materia ${index + 1}: ${materia.nombre_materia} ---`);
    console.log("Sesión 1:", materia.desglose_horas.horas_clase_1);
    console.log("Sesión 2:", materia.desglose_horas.horas_clase_2);
    console.log("Sesión 3:", materia.desglose_horas.horas_clase_3);
    console.log("Sesión 4:", materia.desglose_horas.horas_clase_4);
    console.log("Sesión 5:", materia.desglose_horas.horas_clase_5);
});
        console.log(Alonzo_Lara_Flores.lista_horas_lunes_docente)
        console.log(Alonzo_Lara_Flores.lista_horas_martes_docente)
        console.log(Alonzo_Lara_Flores.lista_horas_miercoles_docente)
        console.log(Alonzo_Lara_Flores.lista_horas_jueves_docente)
        console.log(Alonzo_Lara_Flores.lista_horas_viernes_docente)
        console.log(Alonzo_Lara_Flores.lista_horas_sabado_docente)

        LAGE_1ro_NA_A.asignarDocenteAMateria("FUNDAMENTOS DE LA ADMINISTRACION", Andres_Dimas_Espino)
        LAGE_1ro_NA_A.asignarDocenteAMateria("TUTORIA 1RO", Andres_Dimas_Espino)

        console.log(Andres_Dimas_Espino.nombre_docente)
        console.log(Andres_Dimas_Espino.horas_carga)
        console.log(Andres_Dimas_Espino.materias_impartidas_docente)
        console.log(Andres_Dimas_Espino.lista_horas_lunes_docente)
        console.log(Andres_Dimas_Espino.lista_horas_martes_docente)
        console.log(Andres_Dimas_Espino.lista_horas_miercoles_docente)
        console.log(Andres_Dimas_Espino.lista_horas_jueves_docente)
        console.log(Andres_Dimas_Espino.lista_horas_viernes_docente)
        console.log(Andres_Dimas_Espino.lista_horas_sabado_docente)

        //Funcion para determinar el orden en el que se crearan los horarios de los docentes
        for (const docente of Docente.lista_docentes) {

            if(docente.dispoinibilidad_lunes !== "-"){
                docente.cantidad_dias_disponibles += 1
            }
            if(docente.dispoinibilidad_martes !== "-"){
                docente.cantidad_dias_disponibles += 1
            }
            if(docente.dispoinibilidad_miercoles !== "-"){
                docente.cantidad_dias_disponibles += 1
            }
            if(docente.dispoinibilidad_jueves !== "-"){
                docente.cantidad_dias_disponibles += 1   
            }
            if(docente.dispoinibilidad_viernes !== "-"){
                docente.cantidad_dias_disponibles += 1  
            }
            if(docente.dispoinibilidad_sabado !== "-"){
                docente.cantidad_dias_disponibles += 1  
            }


            // 2. Calcular prioridad evitando división por cero
            if (docente.horas_carga > 0) {
                docente.prioridad = (docente.horas_disponibilidad / docente.horas_carga) * (docente.cantidad_dias_disponibles) * (docente.tipo_docente);
            } else {
                docente.prioridad = 0; // O la lógica que prefieras para docentes sin carga
            }
            
        }
        //reacomodamos la lista de docentes segun su prioridad
        Docente.lista_docentes.sort((a, b) => a.prioridad - b.prioridad);
        

        Docente.lista_docentes.forEach((docente, index) => {
            console.log(`${index + 1}. Docente: ${docente.nombre_docente} | Prioridad: ${docente.prioridad.toFixed(2)}`);
        })

        

        function estaDisponible(hora, disponibilidad_cadena) {
            if (!disponibilidad_cadena || disponibilidad_cadena === "-") return false;
    
            // Separamos por espacios por si hay rangos múltiples
            const rangos = disponibilidad_cadena.split(" ");
    
            return rangos.some(rango => {
                const [inicio, fin] = rango.split("-").map(Number);
                // Verificamos si la hora está dentro del rango
                // Usamos >= inicio y < fin (común en horarios)
                return hora >= inicio && hora < fin;
            })
        }

        
        //Funcion de impresion en el excel--------------------------------------------------------------------------------------------------------------------------------------------------------------------
        button_accion.addEventListener("click", descargar_documentos)

        //Funcion de descarga del excel de disponibilidades de docentes
        function generar_excel_disponibilidad_docentes() {
            // 1. Crear un nuevo libro de trabajo (Workbook)
            const workbook = XLSX.utils.book_new();

            // 3. Iterar la lista y crear una hoja por cada docente
            Docente.lista_docentes.forEach(docente => {
                const filasDeHoras = HORAS.map(hora => [hora]);

                const datosHoja = [
                    ["Docente: " + docente.nombre_docente], // Fila 1 (A1)
                    ["Disponbilidad total (horas): " + docente.horas_disponibilidad], // Fila 1 (A2)
                    ["Horas carga (horas): " + docente.horas_carga], // Fila 3 (A3)
                    ["DÍAS:", ...DIAS.map(d => d.toUpperCase())] // Fila 3 (A4) en diferentes columnas
                    
                ]

                HORAS.forEach(hora => {
                    // La primera columna es la hora
                    const fila = [hora]; 

                    // Recorremos cada día para ver si ponemos "X" o vacío
                    DIAS.forEach(dia => {
                        // Accedemos a la propiedad dinámica: docente.dispoinibilidad_lunes, etc.
                        const dispDia = docente[`dispoinibilidad_${dia}`];
                
                        if (estaDisponible(hora, dispDia)) {
                            fila.push("X"); // Marcamos con una X si está disponible
                        } else {
                            fila.push(""); // Vacío si no
                        }
                    })

                    datosHoja.push(fila)
                })
                
                
                // Creamos una hoja de un array de impresion.
                const worksheet = XLSX.utils.aoa_to_sheet(datosHoja)

                // Limpiar nombre (máximo 31 caracteres y quitar caracteres prohibidos)
                const nombreHoja = docente.nombre_docente.substring(0, 31)

                // 4. Añadir la hoja al libro con el nombre del docente
                XLSX.utils.book_append_sheet(workbook, worksheet, nombreHoja)
            })

            // 5. Generar y descargar el archivo
            // Esta función en el navegador dispara la descarga automáticamente
            XLSX.writeFile(workbook, 'Disponibilidad_docentes.xlsx');
        }

        function generar_excel_horarios_grupos() {
            // 1. Crear un nuevo libro de trabajo
            const workbook = XLSX.utils.book_new();
                
            // 2. Iterar el array estático de la clase Grupo
            Grupo.lista_grupos_LAGE.forEach(grupo => {
                
                // Estructura base: Título y Encabezado de columnas
                const datosHoja = [
                    ["Horario del grupo: " + grupo.nombre_grupo], // Fila 1: Título
                    [],                                           // Fila 2: Espacio en blanco
                    ["HORA", ...DIAS.map(d => d.toUpperCase())]   // Fila 3: Cabecera (HORA, LUNES, MARTES...)
                ];
            
                // 3. Generar las filas de horas
                HORAS.forEach(hora => {
                    // Creamos una fila que empieza con la hora y tiene celdas vacías para cada día
                    const fila = [hora, ...DIAS.map(() => "")]; 
                    datosHoja.push(fila);
                });
                
                // 4. Convertir el Array de Arrays (AOA) a una hoja (Worksheet)
                const worksheet = XLSX.utils.aoa_to_sheet(datosHoja);
            
                // 5. Configurar anchos de columna (Opcional, para que se vea bien)
                // La columna A (Hora) más ancha, las demás estándar
                worksheet['!cols'] = [{ wch: 15 }, ...DIAS.map(() => ({ wch: 12 }))];
            
                // 6. Limpiar el nombre de la hoja (Excel solo acepta 31 caracteres y sin caracteres especiales)
                const nombreLimpio = grupo.nombre_grupo.toString()
                    .replace(/[\\\/\?\*\[\]]/g, "") 
                    .substring(0, 31);
            
                // 7. Añadir la hoja al libro
                XLSX.utils.book_append_sheet(workbook, worksheet, nombreLimpio);
            });
        
            // 8. Descargar el archivo final
            XLSX.writeFile(workbook, 'Horarios_Grupos_LAGE.xlsx');
        }

        function generar_excel_horarios_docentes(){

        }

        //Funcion madre de descarga de documentos
        function descargar_documentos(){
            generar_excel_disponibilidad_docentes()
            generar_excel_horarios_grupos()
            generar_excel_horarios_docentes()

        }



    </script>
</body>
</html>